{"dev_input": {"input_path": "ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/documents/out/map_records"}, "options": {"provenance_tracking": true, "auto_provenance": false}, "fields": [{"label": "__model_result", "lines": [{"function_id": {"name": "get_raw_extracted_fields", "source": "NATIVE"}, "inputs": [{"arg_name": "INPUT_COL", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "KEYWORD", "data_type_options": ["TEXT"], "value": "INPUT_COL"}, {"arg_name": "fields_to_extract", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "[{\"name\": \"Name\", \"prompt\": \"Name\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Extract the full name of the claimant or patient. If not mentioned, return 'N/A'.\", \"model_type\": \"ADVANCED\", \"position\": 0}, {\"name\": \"Postal_Code\", \"prompt\": \"Please provide the patient's address.\", \"prompt_type\": \"advanced\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"What is the\", \"model_type\": \"DEFAULT\", \"position\": 1}, {\"name\": \"Patient_Occupation\", \"prompt\": \"What is the occupation of the patient?\", \"prompt_type\": \"advanced\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Return the occupation of the patient\", \"model_type\": \"DEFAULT\", \"position\": 2}, {\"name\": \"Date_of_Medical_Examination\", \"prompt\": \"Date of Medical Examination\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Extract the date of medical examination if it is not mentioned return 'N/A'.\", \"model_type\": \"ADVANCED\", \"position\": 3}, {\"name\": \"Claimant_Involved_in_a_Previous_Accident\", \"prompt\": \"Has the claimant been previously involved in an accident?\\nConsider it as \\\"Yes\\\" if the document contains date of accident.\", \"prompt_type\": \"advanced\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Has the claimant been involved in a previous accident?\\nReturn 'No' if not found.\", \"model_type\": \"DEFAULT\", \"position\": 4}, {\"name\": \"Time_Taken_off_Work\", \"prompt\": \"Time Taken off Work\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Return the time taken off work. Return 'Not Known' if not found.\", \"model_type\": \"DEFAULT\", \"position\": 5}, {\"name\": \"Hobbies_Affected\", \"prompt\": \"Have the patient's hobbies been affected?\", \"prompt_type\": \"advanced\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Has the patient's hobbies been affected?\", \"model_type\": \"ADVANCED\", \"position\": 6}, {\"name\": \"Domestic_Duties_Affected\", \"prompt\": \"Has the patient's ability to perform domestic duties been affected?\", \"prompt_type\": \"advanced\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Has the patient's domestic duties been affected?\\n\\nAnswer in 'Yes', 'No', 'Not Known' (not found), or 'Not Applicable'\", \"model_type\": \"DEFAULT\", \"position\": 7}, {\"name\": \"Injury_Body_Parts\", \"prompt\": \"Injury Body Parts\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT_LIST\", \"prompt_schema\": null, \"description\": \"The patient's injured body part\", \"model_type\": \"DEFAULT\", \"position\": 8}, {\"name\": \"Injury_Dominant_Body_Part\", \"prompt\": \"\", \"prompt_type\": \"udf\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"\", \"model_type\": \"DEFAULT\", \"position\": 9}, {\"name\": \"Previous_Injury\", \"prompt\": \"\", \"prompt_type\": \"derived\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"\", \"model_type\": \"ADVANCED\", \"position\": 10}, {\"name\": \"Injury_Types\", \"prompt\": \"Injury Types\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT_LIST\", \"prompt_schema\": null, \"description\": \"Extract all the categories of injuries in the given context\", \"model_type\": \"DEFAULT\", \"position\": 11}, {\"name\": \"Prognosis_Period\", \"prompt\": \"What is the total prognosis period for the injuries in the context?\", \"prompt_type\": \"advanced\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"What is the prognosis period for the injuries in the context?\", \"model_type\": \"DEFAULT\", \"position\": 12}, {\"name\": \"Treatment\", \"prompt\": \"Treatment\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT_LIST\", \"prompt_schema\": null, \"description\": \"What are the treatments for injuries in the given context?\", \"model_type\": \"ADVANCED\", \"position\": 13}, {\"name\": \"Time_to_Treatment\", \"prompt\": \"How much total time is required for the treatment?\", \"prompt_type\": \"advanced\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"What is the total time required for the treatment in days, weeks, or months in the context?\", \"model_type\": \"ADVANCED\", \"position\": 14}, {\"name\": \"Exceptional_Uplift_Requested\", \"prompt\": \"Exceptional Uplift Requested\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Has an exceptional uplift been requested? \\nAnswer in 'Yes' or 'No''.\\nReturn 'No' if not found.\", \"model_type\": \"DEFAULT\", \"position\": 15}, {\"name\": \"Exceptional_Uplift\", \"prompt\": \"Exceptional Uplift\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Uplift percentage. \\nReturn 'N/A' if nothing is me.\", \"model_type\": \"DEFAULT\", \"position\": 16}, {\"name\": \"Exceptional_Uplift_Justification\", \"prompt\": \"Exceptional Uplift Justification\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Extract the Exceptional Uplift Justification. If not found, return 'N/A'.\", \"model_type\": \"DEFAULT\", \"position\": 17}, {\"name\": \"Expert_Last_Name\", \"prompt\": \"Expert Last Name\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Expert Last Name\", \"model_type\": \"ADVANCED\", \"position\": 18}, {\"name\": \"Professional_ID\", \"prompt\": \"What is the Professional ID of the expert, either a 7-digit GMC ID or an HCPC ID in the format of 2 letters followed by 3 digits?\", \"prompt_type\": \"advanced\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Extract Professional ID, it can be under the name GMC expert ID which will include 7 digits or HCPC expert ID as PH123, return 'N/A' if nothing is mentioned.\", \"model_type\": \"DEFAULT\", \"position\": 19}, {\"name\": \"Solicitor_Suggested_Offer\", \"prompt\": \"Solicitor Suggested Offer\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Total offer amount suggested by the solicitor\\nTotal offer amount = Sum of Tariff and Non-Tariff\\nReturn 'N/A' if not found.\", \"model_type\": \"DEFAULT\", \"position\": 20}, {\"name\": \"Solicitor_Company\", \"prompt\": \"Solicitor Company\", \"prompt_type\": \"basic\", \"values\": {}, \"data_type\": \"TEXT\", \"prompt_schema\": null, \"description\": \"Return the Solicitor Company and make it title case. \\nReturn 'N/A' if not found.\", \"model_type\": \"DEFAULT\", \"position\": 21}]"}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}]}]}, {"label": "Name", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Name\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Remove honorific words if any and make title case\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Name@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Postal_Code", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Postal_Code\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"What is the postal code? If it is not mentioned, return 'N/A'.\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Postal_Code@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "upper", "source": "NATIVE"}, "inputs": [{"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Postal_Code@1"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Patient_Occupation", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Patient_Occupation\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Map the occupation to 'Driver', 'Non-Physical / Office', 'Physical', 'Retail / Mobile Work', 'Retired' or  'Unemployed'\\n\\nConsider Unemployed if not specified\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Patient_Occupation@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Map the occupation to 'Driver', 'Non-Physical / Office', 'Physical', 'Retail / Mobile Work', 'Retired' or  'Unemployed'\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Patient_Occupation@1"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/d0094b40-3d53-47bb-bdcb-2ca30f3579a2.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Patient_Occupation@2\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:3162017810:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5411\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef map_value(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport traceback\\n\\t\\n\\ttry:\\n\\t  if 'Non-Physical' in previous_line or 'Office' in previous_line:\\n\\t    return 'Non-Physical / Office'\\n\\t\\n\\t  valid_values = ['Driver', 'Non-Physical / Office', 'Physical', 'Retail / Mobile Work', 'Retired', 'Unemployed']\\n\\t  valid_values = sorted(valid_values, key=len, reverse=True)\\n\\t\\n\\t  for value in valid_values:\\n\\t    if value in previous_line:\\n\\t      return value\\n\\t\\n\\t  return previous_line\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"map_value\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Patient_Occupation@2\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Date_of_Medical_Examination", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Date_of_Medical_Examination\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/477e5939-42a1-486f-bde1-1f5b6e358b2e.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Date_of_Medical_Examination@0\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:1000087326:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5162\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef parse_date(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport traceback\\n\\tfrom dateutil.parser import parse \\n\\t\\n\\ttry:\\n\\t  if previous_line.lower() == 'n/a':\\n\\t    return 'N/A'\\n\\t\\n\\t  date = parse(previous_line, dayfirst=True, fuzzy=True)\\n\\t  return date.strftime('%d/%m/%Y')\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"parse_date\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Date_of_Medical_Examination@0\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Claimant_Involved_in_a_Previous_Accident", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Claimant_Involved_in_a_Previous_Accident\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Convert the answer to 'Yes' or 'No'\\nConsider unknown as 'No'\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Claimant_Involved_in_a_Previous_Accident@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Time_Taken_off_Work", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Time_Taken_off_Work\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Convert the answer in days or from ['None', 'Not Known']\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Time_Taken_off_Work@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/d314a1d0-0eb3-420b-ac01-2e4391b56cae.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Time_Taken_off_Work@1\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:2802133509:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5122\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef convert_days(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport traceback\\n\\t\\n\\ttry:\\n\\t  if previous_line in ['None', 'Not Known']:\\n\\t    return previous_line\\n\\t\\n\\t  days = previous_line.lower()\\n\\t  days = days.replace('days', '').replace('day', '')\\n\\t  days = days.strip()\\n\\t  days = int(days)\\n\\t\\n\\t  if days < 7:\\n\\t    return 'Less than a week'\\n\\t  elif days in range(7, (2*7)+1):\\n\\t    return '1-2 weeks'\\n\\t  elif days in range(2*7, (4*7)+1):\\n\\t    return '2-4 weeks'\\n\\t  elif days in range(4*7, (5*7)+1):\\n\\t    # 4-5 weeks\\n\\t    return '1 month'\\n\\t  elif days in range(5*7, (6*7)+1):\\n\\t    # 5-6 weeks\\n\\t    return '6 weeks'\\n\\t  else:\\n\\t    months = round(days / 30)\\n\\t    return f'{months} months'\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t  \""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"convert_days\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Time_Taken_off_Work@1\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Hobbies_Affected", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Hobbies_Affected\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Convert the answer to 'Yes', 'No', or 'Not Known'\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Hobbies_Affected@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Domestic_Duties_Affected", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Domestic_Duties_Affected\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Convert the answer to 'Yes', 'No', 'Not Known', or 'Not Applicable'\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Domestic_Duties_Affected@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Injury_Body_Parts", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Injury_Body_Parts\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/b1e10f00-f545-4c64-b5f4-e31b79df854a.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Injury_Body_Parts@0\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:7604995814:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5506\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef seperate(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport traceback\\n\\timport json\\n\\tfrom functools import reduce\\n\\t\\n\\ttry:\\n\\t  items = json.loads(previous_line)\\n\\t\\n\\t  items = reduce(lambda x, y: x+y.split(','), items, [])\\n\\t  items = reduce(lambda x, y: x+y.split('and'), items, [])\\n\\t  items = list(map(lambda x: x.strip(), items))\\n\\t  items = sorted(items)\\n\\t\\n\\t  return items\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"seperate\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Injury_Body_Parts@0\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Convert the answer in ['Thumb and fingers', 'Psychological', 'Lower back', 'Upper back', 'Lower leg', 'Upper arm', 'Upper leg', 'Fore arm', 'Shoulder', 'Fingers', 'Stomach', 'Organs', 'Ankle', 'Chest', 'Elbow', 'Groin', 'Mouth', 'Other', 'Thumb', 'Torso', 'Wrist', 'Back', 'Ears', 'Eyes', 'Face', 'Foot', 'Hand', 'Head', 'Hips', 'Knee', 'Legs', 'Neck', 'Nose', 'Ribs', 'Toes', 'Arm'] \\nConsider Fear or Anxiety as  Psychological and consider whiplash as Neck\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT_LIST\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Injury_Body_Parts@1"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/a796bee2-0d4a-40ba-9574-83c68fd3798e.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Injury_Body_Parts@2\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:3065219129:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5605\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef map_values(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport json\\n\\tfrom difflib import get_close_matches\\n\\t\\n\\tbody_parts = ['Thumb and fingers', 'Psychological', 'Lower back', 'Upper back', 'Lower leg',\\n\\t 'Upper arm', 'Upper leg', 'Fore arm', 'Shoulder', 'Fingers', 'Stomach', 'Organs', 'Ankle', 'Chest', 'Elbow', 'Groin', 'Mouth', 'Other', 'Thumb', 'Torso', 'Wrist', 'Back', 'Ears', 'Eyes', 'Face', 'Foot', 'Hand', 'Head', 'Hips', 'Knee', 'Legs', 'Neck', \\n\\t'Nose', 'Ribs', 'Toes', 'Arm']\\n\\t\\n\\tdef map_value(word):\\n\\t  matches = get_close_matches(word, body_parts, n=1, cutoff=0.8)\\n\\t  return matches[0] if matches else word\\n\\t\\n\\tprevious_line = json.loads(previous_line)\\n\\t\\n\\tvalues = list(map(map_value, previous_line))\\n\\tvalues = list(filter(lambda x: x not in [None, 'N/A', 'None', ''], values))\\n\\t\\n\\treturn values\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"map_values\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Injury_Body_Parts@2\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/1009c515-ba66-4999-9b3c-4a94f0cabf8a.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Injury_Body_Parts@3\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:3388026775:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5071\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef unique(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport json\\n\\timport traceback\\n\\t\\n\\ttry:\\n\\t  items = json.loads(previous_line)\\n\\t  items = list(set(items))\\n\\t  items = sorted(items)\\n\\t\\n\\t  return items\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"unique\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Injury_Body_Parts@3\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Injury_Dominant_Body_Part", "lines": [{"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/29dfb412-7c80-447f-ac6d-9b7e86acf1e9.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"Injury_Body_Parts\",\"data_type\":\"FIELD\",\"value\":\"Injury_Body_Parts\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:2791021495:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5184\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef get_dominant_body_part(Injury_Body_Parts, context = {}, keys = {}, **kwargs):\\n\\timport json\\n\\timport traceback\\n\\t\\n\\tdominant_parts = ['Shoulder', 'Arm', 'Upper arm', 'Elbow', 'Fore arm', 'Wrist', 'Hand', 'Fingers', 'Thumb'] \\n\\t\\n\\ttry:\\n\\t  Injury_Body_Parts = json.loads(Injury_Body_Parts)\\n\\t\\n\\t  if not Injury_Body_Parts:\\n\\t    return 'Not Known'\\n\\t  else:\\n\\t    for body_part in Injury_Body_Parts:\\n\\t      if body_part in dominant_parts:\\n\\t        return 'Yes'\\n\\t\\n\\t  return 'No'\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return 'Not Known'\\n\\t  \""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"get_dominant_body_part\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"FIELD\",\"value\":\"Injury_Body_Parts\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{\"metrics_params\": {\"data_type\": \"DICT\", \"value\": \"{\\\"source_id\\\": \\\"Unknown\\\", \\\"source_type\\\": \\\"App\\\", \\\"user_agent\\\": \\\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\\\"}\"}}"}], "output_type": "TEXT"}]}, {"label": "Previous_Injury", "lines": [{"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Is \\\\ Injury Body Parts \\\\ injury from a previous injury?\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[{\"data_type\": \"ANY\", \"value\": \"\\\"Injury_Body_Parts\\\"\"}]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[{\"data_type\": \"FIELD\", \"value\": \"Injury_Body_Parts\"}]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[{\"data_type\": \"ANY\", \"value\": \"\\\"TEXT_LIST\\\"\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Convert the answer in ['Yes', 'No']\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Previous_Injury@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Injury_Types", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Injury_Types\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/bf5c9313-dd4a-42d4-81fa-2195e93f0f80.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Injury_Types@0\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:1977107462:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5070\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef separate(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport traceback\\n\\timport json\\n\\tfrom functools import reduce\\n\\t\\n\\ttry:\\n\\t  items = json.loads(previous_line)\\n\\t\\n\\t  items = reduce(lambda x, y: x+y.split(','), items, [])\\n\\t  items = list(map(lambda x: x.strip(), items))\\n\\t  items = list(set(items))\\n\\t  items = sorted(items)\\n\\t\\n\\t  return items\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"separate\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Injury_Types@0\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Convert each category into  'Bruise', 'Burns', 'Headache', 'Concussion', 'Cuts', 'Dislocation', 'Dizziness', 'Fracture', 'PTSD', 'Paraesthesia', 'Paresthesia', 'Radiation/referred pain', 'Scarring', 'Sleep loss', 'Soft tissue', 'Soreness', 'Sprain', 'Swelling', 'Tinnitus', 'Anxiety', 'Tooth damage', 'Travel anxiety' and if category is not in this, consider it as 'Other' and Consider Whiplash as Soft tissue and non-whiplash as Other\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT_LIST\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Injury_Types@1"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/c8b5c874-4c8d-44f7-b6c3-0102d3857780.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Injury_Types@2\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:3103390517:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5606\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef map_values(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport json\\n\\tfrom difflib import get_close_matches\\n\\t\\n\\tinjury_types = ['Anxiety', 'Bruise', 'Burns', 'Concussion', 'Cuts', 'Dislocation', 'Dizziness', 'Fracture', 'Headache', 'PTSD', 'Paraesthesia', 'Paresthesia', 'Radiation/referred pain', 'Scarring', 'Sleep loss', 'Soft tissue', 'Soreness', 'Sprain', 'Swelling', 'Tinnitus', 'Tooth damage', 'Travel anxiety', 'Other']\\n\\t\\n\\tdef map_value(word):\\n\\t  matches = get_close_matches(word, injury_types, n=1, cutoff=0.8)\\n\\t  return matches[0] if matches else word\\n\\t\\n\\tprevious_line = json.loads(previous_line)\\n\\t\\n\\treturn list(map(map_value, previous_line))\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"map_values\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Injury_Types@2\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/545982be-699d-480f-8c6c-28c135f2a5ca.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Injury_Types@3\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:2443396379:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5140\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef unique(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport json\\n\\timport traceback\\n\\t\\n\\ttry:\\n\\t  items = json.loads(previous_line)\\n\\t\\n\\t  items = list(set(items))\\n\\t  items = sorted(items)\\n\\t\\n\\t  return items\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t  \""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"unique\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Injury_Types@3\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Prognosis_Period", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Prognosis_Period\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Consider the highest period as the prognosis period\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Prognosis_Period@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"If the prognosis period is not mentioned return 'Not Known'\\nFor range consider the upper limit.\\nIf it is lifelong then return 'Lifelong'\\nIf it is given in weeks and is less than 52 weeks then return as 'n Weeks'\\nIf it is given in months and is less than 36 months then return as 'n Months'\\nIf it is given in years then return as 'n Years'\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Prognosis_Period@1"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Treatment", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Treatment\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/fca9865b-1195-46cc-af26-8aea37236041.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Treatment@0\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:4011010628:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5141\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef separate(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport traceback\\n\\timport json\\n\\tfrom functools import reduce\\n\\t\\n\\ttry:\\n\\t  items = json.loads(previous_line)\\n\\t\\n\\t  items = reduce(lambda x, y: x+y.split(','), items, [])\\n\\t  items = reduce(lambda x, y: x+y.split('.'), items, [])\\n\\t\\n\\t  items = list(map(lambda x: x.strip(), items))\\n\\t  # items = list(set(items))\\n\\t  items = sorted(items)\\n\\t  # items = json.dumps(items)\\n\\t  return items\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"separate\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Treatment@0\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Convert each treatment into 'Surgery,''CBT', 'Chiropractor', 'Medication (Not prescribed)', 'Physio', 'Prescribed medication', 'Self-exercise', 'None', 'Not Known', 'Other'\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT_LIST\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Treatment@1"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/68447f57-cd28-4660-977c-618e5c88d6f5.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Treatment@2\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:1051606199:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5607\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef map_values(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport json\\n\\tfrom difflib import get_close_matches\\n\\t\\n\\ttreatments = ['CBT', 'Chiropractor', 'Medication (Not prescribed)', 'Physio', 'Prescribed medication', 'Self-exercise', 'Surgery', 'None', 'Not Known', 'Other']\\n\\t\\n\\tdef map_value(word):\\n\\t  matches = get_close_matches(word, treatments, n=1, cutoff=0.8)\\n\\t  return matches[0] if matches else word\\n\\t\\n\\tprevious_line = json.loads(previous_line)\\n\\t\\n\\treturn list(map(map_value, previous_line))\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"map_values\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Treatment@2\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/ce6873f1-1bfe-427b-bb45-afffb26357e1.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Treatment@3\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:1507879095:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5097\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef unique(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport traceback\\n\\t\\n\\ttry:\\n\\t  import json\\n\\t\\n\\t  items = json.loads(previous_line)\\n\\t  items = list(map(lambda x: x.strip(), items))\\n\\t  # items = list(map(lambda x: x['Treatment'].strip(), items))\\n\\t\\n\\t  valid_values = ['CBT', 'Chiropractor', 'Medication (Not prescribed)', 'Physio', 'Prescribed medication', 'Self-exercise', 'Surgery', 'None', 'Not Known', 'Other']\\n\\t  \\n\\t  def check_valid_value(item):\\n\\t    for valid_value in valid_values:\\n\\t      if valid_value in item:\\n\\t        return valid_value\\n\\t    return item\\n\\t\\n\\t  items = map(check_valid_value, items)\\n\\t  items = list(set(items))\\n\\t  items = sorted(items)\\n\\t  filtered_items = list(filter(lambda x: x not in ['None', 'Not Known', 'N/A', ''], items))\\n\\t  \\n\\t  if filtered_items:\\n\\t    items = filtered_items\\n\\t  elif 'None' in items:\\n\\t    items = ['None']\\n\\t  else:\\n\\t    items = ['Not Known']\\n\\t\\n\\t  # items = list(map(lambda x: {'Treatment': x}, items))\\n\\t  return items\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"unique\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Treatment@3\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Time_to_Treatment", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Time_to_Treatment\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Return the answer in days (consider the upper limit for range) or from ['None', 'Not Known', 'Not applicable']\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Time_to_Treatment@0"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "refine_field_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "prompt", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"Return the answer in days (consider the upper limit for range) or from ['None', 'Not Known', 'Not applicable']\""}, {"arg_name": "metrics_params", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"source_id\": \"Unknown\", \"source_type\": \"App\", \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36\"}"}, {"arg_name": "proj_uuid", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"01937664-649c-79b8-9347-17870e4835fe\""}, {"arg_name": "cached_index", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "custom_request", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "{\"enable_map_reduce_extraction\": true, \"confidence_for_reasoning\": true}"}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "data_type", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"TEXT\""}, {"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Time_to_Treatment@1"}, {"arg_name": "prompt_arg_names", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_vals", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "prompt_arg_data_types", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LIST", "data_type_options": ["TEXT"], "value": "[]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/27d17c9f-d269-4b42-bba1-7aa548d5b31e.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Time_to_Treatment@2\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:2631350642:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5123\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef convert_days(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport traceback\\n\\t\\n\\ttry:\\n\\t  if previous_line in ['None', 'Not Known', 'Not applicable']:\\n\\t    return previous_line\\n\\t\\n\\t  days = previous_line.lower()\\n\\t  days = days.replace('days', '').replace('day', '')\\n\\t  days = days.strip()\\n\\t\\n\\t  if '-' in days:\\n\\t    days = days.split('-')[-1]\\n\\t\\n\\t  days = int(days)\\n\\t\\n\\t  if days < 7:\\n\\t    return 'Less than a week'\\n\\t  elif days in range(7, (2*7)+1):\\n\\t    return '1-2 weeks'\\n\\t  elif days in range(2*7, (4*7)+1):\\n\\t    return '2-4 weeks'\\n\\t  elif days in range(4*7, (5*7)+1):\\n\\t    # 4-5 weeks\\n\\t    return '1 month'\\n\\t  elif days in range(5*7, (6*7)+1):\\n\\t    # 5-6 weeks\\n\\t    return '6 weeks'\\n\\t  else:\\n\\t    months = round(days / 30)\\n\\t    return f'{months} months'\\n\\t\\n\\texcept Exception:\\n\\t  print(traceback.format_exc())\\n\\t  return previous_line\\n\\t  \""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"convert_days\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Time_to_Treatment@2\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Exceptional_Uplift_Requested", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Exceptional_Uplift_Requested\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Exceptional_Uplift", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Exceptional_Uplift\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Exceptional_Uplift_Justification", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Exceptional_Uplift_Justification\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Expert_Last_Name", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Expert_Last_Name\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "proper", "source": "NATIVE"}, "inputs": [{"arg_name": "previous_line", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "LINE", "data_type_options": ["TEXT"], "value": "Expert_Last_Name@0"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Professional_ID", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Professional_ID\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}, {"function_id": {"name": "run_udf_in_lambda_v2", "source": "NATIVE"}, "inputs": [{"arg_name": "absolute_scripts_path", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"ib-internal/SolEng_workspace/fs/Instabase Drive/aihub/01937664-649c-79b8-9347-17870e4835fe/project/modules/scripts/REFINER/e66b5ac1-34dd-4380-ba61-0047435a4670.json\""}, {"arg_name": "function_args", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "[{\"name\":\"previous_line\",\"data_type\":\"LINE\",\"value\":\"Professional_ID@0\"}]"}, {"arg_name": "lambda_udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"v1:AWS_LAMBDA:1311424843:insaprd-use2-aihub-prd-docker-default-udf:8\""}, {"arg_name": "doc_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "null", "default": "null"}, {"arg_name": "udf_id", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"5182\""}, {"arg_name": "code_arg", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"\\n\\ndef get_pro_id(previous_line, context = {}, keys = {}, **kwargs):\\n\\timport re\\n\\t\\n\\tpattern = r'\\\\b(([A-Z]{2}\\\\d{3}|\\\\d{7}))\\\\b'\\n\\tmatch = re.search(pattern, previous_line.upper())\\n\\t\\n\\treturn match.group() if match else 'N/A'\\n\\t\""}, {"arg_name": "fn_name", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "TEXT", "data_type_options": ["TEXT"], "value": "\"get_pro_id\""}, {"arg_name": "args", "arg_type": "VAR_POSITIONAL", "data_type": "LIST", "value": "[{\"data_type\":\"LINE\",\"value\":\"Professional_ID@0\"}]"}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Solicitor_Suggested_Offer", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Solicitor_Suggested_Offer\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}, {"label": "Solicitor_Company", "lines": [{"function_id": {"name": "get_extracted_field_value", "source": "NATIVE"}, "inputs": [{"arg_name": "fields", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "FIELD", "data_type_options": ["TEXT"], "value": "__model_result"}, {"arg_name": "field", "arg_type": "POSITIONAL_OR_KEYWORD", "data_type": "ANY", "data_type_options": ["TEXT"], "value": "\"Solicitor_Company\""}, {"arg_name": "kwargs", "arg_type": "VAR_KEYWORD", "data_type": "DICT", "data_type_options": ["DICT"], "value": "{}"}], "output_type": "TEXT"}]}]}